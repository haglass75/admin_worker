<template>
  <div
    class="space-y-6 bg-white text-black dark:bg-black dark:text-white p-4 rounded">
    <!-- Font Awesome CDN ì¶”ê°€ -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />

    <h1 class="text-3xl font-bold text-gray-800 dark:text-white">
      ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ
    </h1>

    <!-- í†µê³„ ì¹´ë“œ -->

    <DashboardStats :stats="stats" />
    <!-- ì˜ˆì•½ í˜„í™© -->
    <div
      class="bg-white dark:bg-gray-800 rounded-lg shadow text-gray-700 dark:text-gray-300">
      <!-- ê²€ìƒ‰ í•„í„° -->
      <div class="p-4 border-b border-gray-200 dark:border-gray-700">
        <h2 class="text-lg font-semibold text-gray-800 dark:text-white mb-2">
          ì˜ˆì•½ í˜„í™©
        </h2>
        <!-- space-y-4 -->
        <!-- ì„¸ë¡œ(yì¶•)ë¡œ ìš”ì†Œ ì‚¬ì´ì— 1rem(=16px) ë§Œí¼ ê°„ê²©ì„ ì¤ë‹ˆë‹¤.
ğŸ§± 4. xl:space-y-0
xl: â†’ 1200px ì´ìƒì¼ ë•Œë§Œ ì ìš© (Tailwind ê¸°ë³¸ì€ 1280px, ì‚¬ìš©ì ì„¤ì •ì— ë”°ë¼ 1200pxë¡œ ê°€ëŠ¥)
ì¦‰, í° í™”ë©´ì—ì„œëŠ” space-y-0ì´ ë˜ì–´ ì„¸ë¡œ ê°„ê²© ì œê±°
ì´ìœ : ì´ì œ ê°€ë¡œ ì •ë ¬ë¡œ ë°”ë€Œë‹ˆê¹Œ ì„¸ë¡œ ê°„ê²©ì€ í•„ìš” ì—†ìŒ.
ğŸ§± 5. xl:flex-row
1200px ì´ìƒì¼ ë•ŒëŠ” ê°€ë¡œ(row) ë°©í–¥ìœ¼ë¡œ ì •ë ¬
ì¦‰, ì•„ë˜ì²˜ëŸ¼ ì„¸ë¡œ â†’ ê°€ë¡œë¡œ ë°”ë€œ
ğŸ§± 6. xl:items-center
ê°€ë¡œ ì •ë ¬ ì‹œ ì„¸ë¡œ ê°€ìš´ë° ì •ë ¬ì„ í•´ì¤ë‹ˆë‹¤.
ì¦‰, ë†’ì´ê°€ ë‹¤ë¥¸ ë°•ìŠ¤ë¼ë„ ì„¸ë¡œ ë°©í–¥ìœ¼ë¡œ ì¤‘ì•™ì— ë§ì¶°ì§‘ë‹ˆë‹¤.
ğŸ§± 7. xl:justify-between
ê°€ë¡œë¡œ ë‚˜ë€íˆ ë°°ì¹˜ëœ ìš”ì†Œë“¤ì„ ì¢Œìš°ë¡œ ì¼ì •í•˜ê²Œ ë²Œë ¤ì„œ ì •ë ¬í•©ë‹ˆë‹¤.
â†’ ì²« ë²ˆì§¸ ìš”ì†ŒëŠ” ì™¼ìª½ ë, ë§ˆì§€ë§‰ ìš”ì†ŒëŠ” ì˜¤ë¥¸ìª½ ëì— ìœ„ì¹˜.
ğŸ§± 8. xl:space-x-4
ê°€ë¡œ(xì¶•)ë¡œ ìš”ì†Œ ì‚¬ì´ì— 1rem(=16px) ë§Œí¼ ê°„ê²©ì„ ì¤ë‹ˆë‹¤.
ì„¸ë¡œ ì •ë ¬ ë•ŒëŠ” space-y,
ê°€ë¡œ ì •ë ¬ ë•ŒëŠ” space-xë¥¼ ì“°ëŠ” ê²Œ í•µì‹¬ì…ë‹ˆë‹¤. -->
        <div
          class="flex flex-col space-y-4 xl:space-y-0 xl:flex-row xl:items-center xl:justify-between xl:space-x-4">
          <!-- ë‚ ì§œ ì„ íƒ -->
          <div
            class="flex flex-col space-y-2 xl:space-y-0 xl:flex-row xl:items-center xl:space-x-2">
            <label
              class="text-sm font-medium text-gray-700 dark:text-gray-300 whitespace-nowrap"
              >ê¸°ì¤€ì¼</label
            >
            <div
              class="flex flex-col sm:flex-row items-center space-y-2 sm:space-y-0 sm:space-x-2">
              <input
                type="date"
                v-model="dateRange.start"
                class="w-full sm:w-auto px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white" />
              <span class="text-gray-500 dark:text-gray-400">~</span>
              <input
                v-model="dateRange.end"
                type="date"
                class="w-full sm:w-auto px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white" />
            </div>
          </div>

          <!-- ì ‘ìˆ˜ êµ¬ë¶„ -->
          <!-- <div
            class="flex flex-col space-y-2 xl:space-y-0 xl:flex-row xl:items-center xl:space-x-2">
            <label
              class="text-sm font-medium text-gray-700 dark:text-gray-300 whitespace-nowrap"
              >ì ‘ìˆ˜êµ¬ë¶„</label
            >
            <select
              v-model="serviceType"
              class="w-full sm:w-auto px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
              <option value="all">ì „ì²´</option>
              <option value="ì¼ë°˜ì²­ì†Œ">ì¼ë°˜ì²­ì†Œ</option>
              <option value="ì…ì£¼ì²­ì†Œ">ì…ì£¼ì²­ì†Œ</option>
              <option value="ì´ì‚¬ì²­ì†Œ">ì´ì‚¬ì²­ì†Œ</option>
            </select>
          </div> -->

          <!-- ì ‘ìˆ˜ ìƒíƒœ -->
          <!-- <div
            class="flex flex-col space-y-2 xl:space-y-0 xl:flex-row xl:items-center xl:space-x-2">
            <label
              class="text-sm font-medium text-gray-700 dark:text-gray-300 whitespace-nowrap"
              >ì ‘ìˆ˜ìƒíƒœ</label
            >
            <select
              v-model="receiptStatus"
              class="w-full sm:w-auto px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
              <option value="all">ì „ì²´</option>
              <option value="ì˜ˆì•½ì™„ë£Œ">ì˜ˆì•½ì™„ë£Œ</option>
              <option value="ì§„í–‰ì¤‘">ì§„í–‰ì¤‘</option>
              <option value="ëŒ€ê¸°ì¤‘">ëŒ€ê¸°ì¤‘</option>
            </select>
          </div> -->
        </div>
      </div>
      <!-- ì‚¬ìš©ì ì§€ì • props -->
      <!-- ì˜ˆì•½ ëª©ë¡ (ê³µí†µ ì»´í¬ë„ŒíŠ¸ ì‚¬ìš©) 
      :data - ì˜ˆì•½ ëª©ë¡ ë°ì´í„°
      :columns - ì˜ˆì•½ ëª©ë¡ ì»¬ëŸ¼
      search-placeholder - ê²€ìƒ‰ í”Œë ˆì´ìŠ¤í™€ë”
      search-fields - ê²€ìƒ‰ í•„ë“œ
      filter-options - í•„í„° ì˜µì…˜
      filter-fn - í•„í„° í•¨ìˆ˜
      items-per-page - í˜ì´ì§€ë‹¹ ì•„ì´í…œ ìˆ˜
      table-title - í…Œì´ë¸” ì œëª©
      total-label - ì´ ê°œìˆ˜ ë¼ë²¨
      @row-click - í–‰ í´ë¦­ ì´ë²¤íŠ¸ 
      -->
      <SearchTable
        :data="filteredReservaions"
        :columns="reservationColumns"
        search-placeholder="ê³ ê°ëª… ë˜ëŠ” ì˜ˆì•½ë²ˆí˜¸ë¡œ ê²€ìƒ‰..."
        :search-fields="['customerName', 'id']"
        :filter-options="dashboardFilterOptions"
        :filter-fn="dashboardFilterFn"
        :items-per-page="itemsPerPage"
        table-title="ì˜ˆì•½ ëª©ë¡"
        total-label="ê°œ"
        @row-click="handleRowClick" />
    </div>

    <Worker_dash />
    <!-- ì°¨íŠ¸ì™€ ìµœê·¼ ì˜ˆì•½ -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
      <!-- ì°¨íŠ¸ -->
      <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6">
        <h2 class="text-lg font-semibold text-gray-800 dark:text-white mb-4">
          ì˜ˆì•½ ì¶”ì´
        </h2>
        <div class="h-64">
          <Chart />
        </div>
      </div>

      <!-- ìµœê·¼ ì˜ˆì•½ -->
      <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6">
        <h2 class="text-lg font-semibold text-gray-800 dark:text-white mb-4">
          ìµœê·¼ ì˜ˆì•½
        </h2>
        <div class="space-y-4">
          <div
            v-for="reservation in recentReservations"
            :key="reservation.id"
            class="flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
            <div>
              <p class="font-medium text-gray-900 dark:text-white">
                {{ reservation.customerName }}
              </p>
              <p class="text-sm text-gray-500 dark:text-gray-400">
                {{ reservation.date }}
              </p>
            </div>
            <span
              :class="getStatusClass(reservation.status)"
              class="px-2 py-1 text-xs font-semibold rounded-full">
              {{ reservation.status }}
            </span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ì˜ˆì•½ ìƒì„¸ ëª¨ë‹¬ -->
  <div
    v-if="selectedReservation"
    class="fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4 z-50">
    <div
      class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto"
      @click.stop>
      <div class="p-6 border-b border-gray-200 dark:border-gray-700">
        <div class="flex justify-between items-center">
          <h3 class="text-lg font-medium text-gray-900 dark:text-white">
            ì˜ˆì•½ ìƒì„¸ ì •ë³´
          </h3>
          <button
            @click="closeModal"
            class="text-gray-400 hover:text-gray-500 dark:hover:text-gray-300">
            <i class="fas fa-times"></i>
          </button>
        </div>
      </div>
      <div class="p-6">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <!-- ê¸°ë³¸ ì •ë³´ -->
          <div class="space-y-6">
            <div>
              <h4
                class="text-sm font-medium text-gray-500 dark:text-gray-400 mb-2">
                ê¸°ë³¸ ì •ë³´
              </h4>
              <div class="space-y-2">
                <div class="flex items-center">
                  <label
                    class="w-32 text-sm font-medium text-gray-700 dark:text-gray-300"
                    >ì˜ˆì•½ë²ˆí˜¸</label
                  >
                  <span class="text-sm text-gray-900 dark:text-white">{{
                    selectedReservation.id
                  }}</span>
                </div>
                <div class="flex items-center">
                  <label
                    class="w-32 text-sm font-medium text-gray-700 dark:text-gray-300"
                    >ê³ ê°ëª…</label
                  >
                  <input
                    v-model="selectedReservation.customerName"
                    type="text"
                    class="ml-2 px-3 py-1 border border-gray-300 dark:border-gray-600 rounded-md focus:ring-indigo-500 focus:border-indigo-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white" />
                </div>
                <div class="flex items-center">
                  <label
                    class="w-32 text-sm font-medium text-gray-700 dark:text-gray-300"
                    >ì²­ì†Œìœ í˜•</label
                  >
                  <select
                    v-model="selectedReservation.type"
                    class="ml-2 px-3 py-1 border border-gray-300 dark:border-gray-600 rounded-md focus:ring-indigo-500 focus:border-indigo-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                    <option value="ì¼ë°˜ì²­ì†Œ">ì¼ë°˜ì²­ì†Œ</option>
                    <option value="ì…ì£¼ì²­ì†Œ">ì…ì£¼ì²­ì†Œ</option>
                    <option value="ì´ì‚¬ì²­ì†Œ">ì´ì‚¬ì²­ì†Œ</option>
                  </select>
                </div>
                <div class="flex items-center">
                  <label
                    class="w-32 text-sm font-medium text-gray-700 dark:text-gray-300"
                    >ì˜ˆì•½ì¼ì‹œ</label
                  >
                  <input
                    v-model="selectedReservation.date"
                    type="datetime-local"
                    class="ml-2 px-3 py-1 border border-gray-300 dark:border-gray-600 rounded-md focus:ring-indigo-500 focus:border-indigo-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white" />
                </div>
              </div>
            </div>
          </div>

          <!-- ìƒíƒœ ì •ë³´ -->
          <div class="space-y-6">
            <div>
              <h4
                class="text-sm font-medium text-gray-500 dark:text-gray-400 mb-2">
                ìƒíƒœ ì •ë³´
              </h4>
              <div class="space-y-2">
                <div class="flex items-center">
                  <label
                    class="w-32 text-sm font-medium text-gray-700 dark:text-gray-300"
                    >ìƒíƒœ</label
                  >
                  <select
                    v-model="selectedReservation.status"
                    class="ml-2 px-3 py-1 border border-gray-300 dark:border-gray-600 rounded-md focus:ring-indigo-500 focus:border-indigo-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                    <option value="ì˜ˆì•½ì™„ë£Œ">ì˜ˆì•½ì™„ë£Œ</option>
                    <option value="ì§„í–‰ì¤‘">ì§„í–‰ì¤‘</option>
                    <option value="ëŒ€ê¸°ì¤‘">ëŒ€ê¸°ì¤‘</option>
                  </select>
                </div>
                <div class="flex items-center">
                  <label
                    class="w-32 text-sm font-medium text-gray-700 dark:text-gray-300"
                    >ë‹´ë‹¹ê¸°ì‚¬</label
                  >
                  <select
                    v-model="selectedReservation.worker"
                    class="ml-2 px-3 py-1 border border-gray-300 dark:border-gray-600 rounded-md focus:ring-indigo-500 focus:border-indigo-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                    <option value="-">ë¯¸ë°°ì •</option>
                    <option value="ì´ì§€ì€">ì´ì§€ì€</option>
                    <option value="ìµœìœ¤í˜¸">ìµœìœ¤í˜¸</option>
                  </select>
                </div>
              </div>
            </div>

            <div>
              <h4
                class="text-sm font-medium text-gray-500 dark:text-gray-400 mb-2">
                ë©”ëª¨
              </h4>
              <textarea
                v-model="selectedReservation.memo"
                rows="3"
                class="w-full border border-gray-300 dark:border-gray-600 rounded-md px-3 py-2 focus:ring-indigo-500 focus:border-indigo-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white"
                placeholder="ì˜ˆì•½ì— ëŒ€í•œ ë©”ëª¨ë¥¼ ì…ë ¥í•˜ì„¸ìš”"></textarea>
            </div>
          </div>
        </div>
      </div>
      <div
        class="px-6 py-4 bg-gray-50 dark:bg-gray-700 flex justify-end space-x-3">
        <button
          @click="closeModal"
          class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-600">
          ë‹«ê¸°
        </button>
        <button
          @click="saveReservaton"
          class="px-4 py-2 border border-transparent rounded-md text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700">
          ì €ì¥
        </button>
      </div>
    </div>
  </div>

 

 
</template>
<script setup>
import Chart from "@/components/Chart.vue";
import DashboardStats from "@/components/DashboardStats.vue";
import SearchTable from "@/components/SearchTable.vue";
import { ref, computed } from "vue";
import Worker_dash from "@/pages/admin/Worker_dash.vue";
import { resersData } from "@/data/resers.js";
// í†µê³„ì¹´ë“œ ë”ë¯¸
const stats = [
  {
    title: "ì „ì²´ ì˜ˆì•½",
    value: "120",
    change: "+12%",
    icon: "fas fa-calendar-check",
    // bgColor: "bg-blue-100 dark:bg-blue-900",
    // textColor: "text-blue-600 dark:text-blue-300",
    bg: "bg-blue-100",
    color: "text-blue-600",
  },
  {
    title: "ì „ì²´ ì‚¬ìš©ì",
    value: "50",
    change: "+5%",
    icon: "fas fa-users",
    // bgColor: "bg-green-100 dark:bg-green-900",
    // textColor: "text-green-600 dark:text-green-300",
    bg: "bg-green-100",
    color: "text-green-600",
  },
  {
    title: "í‰ê·  í‰ì ",
    value: "4.8",
    change: "+0.2",
    icon: "fas fa-star",
    // bgColor: "bg-yellow-100 dark:bg-yellow-900",
    // textColor: "text-yellow-600 dark:text-yellow-300",
    bg: "bg-yellow-100",
    color: "text-yellow-600",
  },
];
// ì„ íƒëœ ê¸°ì‚¬ ì •ë³´
// const selectedWorker = ref(null);
// ì„ íƒëœ ì˜ˆì•½ ì •ë³´
const selectedReservation = ref(null);
// ì„œë¹„ìŠ¤ìœ í˜•
const serviceType = ref("all");
// ìƒíƒœ
const receiptStatus = ref("all");
// ì˜ˆì•½ ì •ë³´
const reservations = ref([...resersData]);
// const reservations = ref([
  // {
  //   id: "#1001",
  //   customerName: "ê¹€ì² ìˆ˜",
  //   type: "ì¼ë°˜ì²­ì†Œ",
  //   date: "2025-11-10 14:00",
  //   status: "ì˜ˆì•½ì™„ë£Œ",
  //   worker: "ì´ì§€ì€",
  // },
  // {
  //   id: "#1002",
  //   customerName: "ë°•ì˜í¬",
  //   type: "ì…ì£¼ì²­ì†Œ",
  //   date: "2025-11-11 10:00",
  //   status: "ì§„í–‰ì¤‘",
  //   worker: "ìµœìœ¤í˜¸",
  // },
  // {
  //   id: "#1003",
  //   customerName: "ì´ë¯¼ìˆ˜",
  //   type: "ì´ì‚¬ì²­ì†Œ",
  //   date: "2025-11-12 15:00",
  //   status: "ëŒ€ê¸°ì¤‘",
  //   worker: "-",
  // },
  // {
  //   id: "#1004",
  //   customerName: "ì •ë‹¤ì€",
  //   type: "ì¼ë°˜ì²­ì†Œ",
  //   date: "2025-11-13 11:00",
  //   status: "ì˜ˆì•½ì™„ë£Œ",
  //   worker: "ì´ì§€ì€",
  // },
  // {
  //   id: "#1005",
  //   customerName: "ìµœì¤€í˜¸",
  //   type: "ì…ì£¼ì²­ì†Œ",
  //   date: "2025-11-14 09:00",
  //   status: "ëŒ€ê¸°ì¤‘",
  //   worker: "-",
  // },
  // {
  //   id: "#1006",
  //   customerName: "í•œë¯¸ì˜",
  //   type: "ì´ì‚¬ì²­ì†Œ",
  //   date: "2025-11-15 13:00",
  //   status: "ì˜ˆì•½ì™„ë£Œ",
  //   worker: "ìµœìœ¤í˜¸",
  // },
  // {
  //   id: "#1007",
  //   customerName: "ì†¡ë¯¼ì¤€",
  //   type: "ì¼ë°˜ì²­ì†Œ",
  //   date: "2025-11-16 15:00",
  //   status: "ì§„í–‰ì¤‘",
  //   worker: "ì´ì§€ì€",
  // },
  // {
  //   id: "#1008",
  //   customerName: "ìœ¤ì„œì—°",
  //   type: "ì…ì£¼ì²­ì†Œ",
  //   date: "2025-11-17 10:00",
  //   status: "ëŒ€ê¸°ì¤‘",
  //   worker: "-",
  // },
// ]);
// ë‚ ì§œ ë²”ìœ„ í•„í„°
const dateRange = ref({
  start: "", // ì‹œì‘ì¼
  end: "", // ì¢…ë£Œì¼
});
// ë‚ ì§œ ë¬¸ìì—´ì—ì„œ YYYY-MM-DD í˜•ì‹ë§Œ ì¶”ì¶œí•˜ëŠ” í•¨ìˆ˜
//  "YYYY-MM-DD" í˜•ì‹ì…ë‹ˆë‹¤. ì‹œê°„ ë¬¸ì œë¥¼ í”¼í•˜ê¸° ìœ„í•´ ë‚ ì§œ ë¬¸ìì—´ë§Œ ë¹„êµí•˜ë„ë¡ ë³€ê²½í•©ë‹ˆë‹¤.
const extractDateOnly = (dateString) => {
  // "2025-11-17 10:00" í˜•ì‹ì—ì„œ "2025-11-17"ë§Œ ì¶”ì¶œ
  // ë˜ëŠ” ì´ë¯¸ "2025-11-17" í˜•ì‹ì´ë©´ ê·¸ëŒ€ë¡œ ë°˜í™˜
  if (!dateString) return "";
  return dateString.split(" ")[0].split("T")[0];
};

// í•„í„°ë§ëœ ì˜ˆì•½ ëª©ë¡ ê³„ì‚°
const filteredReservaions = computed(() => {
  let result = [...reservations.value]; // ì˜ˆì•½ëª©ë¡ì„ ë³µì‚¬
  //    ë‚ ì§œë¥¼ í•„í„°ë§:ì‹œì‘ì¼ê³¼ ì¢…ë£Œì¼ì„ ì§€ì •í•œ ê²½ìš°, í•´ë‹¹ ë²”ìœ„ë‚´ì˜ ì˜ˆì•½ë‚œ í•„í„°ë§
  // if (dateRange.value.start && dateRange.value.end) {
  //   const startDateStr = extractDateOnly(dateRange.value.start); // "YYYY-MM-DD"
  //   const endDateStr = extractDateOnly(dateRange.value.end); // "YYYY-MM-DD"

  //   result = result.filter((reservation) => {
  //     const reservationDateStr = extractDateOnly(reservation.date); // "YYYY-MM-DD"
  //     // ë¬¸ìì—´ ë¹„êµë¡œ ë‚ ì§œ ë²”ìœ„ í™•ì¸ (ì¢…ë£Œì¼ í¬í•¨)
  //     return (
  //       reservationDateStr >= startDateStr && reservationDateStr <= endDateStr
  //     );
  //   });
  // }
  // ì²­ì†Œì„œë¹„ìŠ¤ ìœ í˜• í•„í„°ë§
  // if (serviceType.value !== "all") {
  //   result = result.filter(
  //     (reservation) => reservation.type === serviceType.value
  //   );
  // }

  // // ì ‘ìˆ˜ ìƒíƒœ í•„í„°ë§
  // if (receiptStatus.value !== "all") {
  //   result = result.filter(
  //     (reservation) => reservation.status === receiptStatus.value
  //   );
  // }

  return result;
});
// í˜ì´ì§€ë„¤ì´ì…˜ ìƒíƒœ
const itemsPerPage = ref(5);

// í…Œì´ë¸” ì»¬ëŸ¼ ì •ì˜
const reservationColumns = [
  { label: "ì˜ˆì•½ë²ˆí˜¸", key: "id" },
  { label: "ê³ ê°ëª…", key: "customerName" },
  { label: "ì²­ì†Œìœ í˜•", key: "type" },
  {
    label: "ì˜ˆì•½ì¼ì‹œ",
    key: "date",

    render: (item) => formatDate(item.date),
  },
  {
    label: "ìƒíƒœ",
    key: "status",
    render: (item) =>
      `<span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${getStatusClass(
        item.status
      )}">${item.status}</span>`,
  },
  { label: "ë‹´ë‹¹ê¸°ì‚¬", key: "worker" },
  {
    label: "ì•¡ì…˜",
    key: "action",
    render: (item) =>
      `<button onclick="window.handleReservationClick('${item.id}')" class="text-indigo-600 dark:text-indigo-400 hover:text-indigo-900 dark:hover:text-indigo-300 mr-3"><i class="fa-solid fa-eye mr-1"></i> ìƒì„¸</button>`,
  },
];

// í•„í„° ì˜µì…˜
const dashboardFilterOptions = [
  {
    key: "serviceType",
    options: [
      { value: "all", label: "ì „ì²´" },
      { value: "ì¼ë°˜ì²­ì†Œ", label: "ì¼ë°˜ì²­ì†Œ" },
      { value: "ì…ì£¼ì²­ì†Œ", label: "ì…ì£¼ì²­ì†Œ" },
      { value: "ì´ì‚¬ì²­ì†Œ", label: "ì´ì‚¬ì²­ì†Œ" },
    ],
  },
  {
    key: "receiptStatus",
    options: [
      { value: "all", label: "ì „ì²´" },
      { value: "ì˜ˆì•½ì™„ë£Œ", label: "ì˜ˆì•½ì™„ë£Œ" },
      { value: "ì§„í–‰ì¤‘", label: "ì§„í–‰ì¤‘" },
      { value: "ëŒ€ê¸°ì¤‘", label: "ëŒ€ê¸°ì¤‘" },
    ],
  },
];

// ì»¤ìŠ¤í…€ í•„í„° í•¨ìˆ˜ (ë‚ ì§œ ë²”ìœ„ í¬í•¨)
const dashboardFilterFn = (data, filters) => {
  let result = [...data];

  // ë‚ ì§œ ë²”ìœ„ í•„í„°ë§
  if (dateRange.value.start && dateRange.value.end) {
    const startDateStr = extractDateOnly(dateRange.value.start);
    const endDateStr = extractDateOnly(dateRange.value.end);

    result = result.filter((reservation) => {
      const reservationDateStr = extractDateOnly(reservation.date);
      // ë¬¸ìì—´ ë¹„êµë¡œ ë‚ ì§œ ë²”ìœ„ í™•ì¸ (ì¢…ë£Œì¼ í¬í•¨)
      return (
        reservationDateStr >= startDateStr && reservationDateStr <= endDateStr
      );
    });
  }

  // ì„œë¹„ìŠ¤ ìœ í˜• í•„í„°ë§
  if (filters.serviceType && filters.serviceType !== "all") {
    result = result.filter(
      (reservation) => reservation.type === filters.serviceType
    );
  }

  // ì ‘ìˆ˜ ìƒíƒœ í•„í„°ë§
  if (filters.receiptStatus && filters.receiptStatus !== "all") {
    result = result.filter(
      (reservation) => reservation.status === filters.receiptStatus
    );
  }

  return result;
};

// í–‰ í´ë¦­ í•¸ë“¤ëŸ¬
const handleRowClick = (item) => {
  showReservationDetails(item);
};

// ì „ì—­ í•¨ìˆ˜ë¡œ ë“±ë¡ (ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì—ì„œ ì‚¬ìš©)
window.handleReservationClick = (id) => {
  const reservation = reservations.value.find((r) => r.id === id);
  if (reservation) {
    showReservationDetails(reservation);
  }
};

// ë‚ ì§œ í¬ë§·ì„ ë³€ê²½í•˜ëŠ” í•¨ìˆ˜
// ì…ë ¥ëœ ë‚ ì§œ ê°’ì„ 'yyyyë…„ MMì›” ddì¼ (ìš”ì¼)' í˜•ì‹ìœ¼ë¡œ ë³€í™˜
const formatDate = (date) => {
  return new Date(date).toLocaleDateString("ko-KR", {
    year: "numeric", // ë…„ë„
    month: "long", // ì›” (í•œê¸€ ì›” ì´ë¦„)
    day: "numeric", // ì¼
    weekday: "long", // ìš”ì¼ (í•œê¸€ ìš”ì¼ ì´ë¦„)
  });
};
// ìƒíƒœ css
const getStatusClass = (status) => {
  const statusClasses = {
    ì˜ˆì•½ì™„ë£Œ:
      "bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-300",
    ì§„í–‰ì¤‘: "bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-300",
    ëŒ€ê¸°ì¤‘: "bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-gray-300",
    í™•ì •: "bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-300",
    ëŒ€ê¸°: "bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-300",
    ì·¨ì†Œ: "bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-300",
    í™œë™ì¤‘: "bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-300",
  };
  return (
    statusClasses[status] ||
    "bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-gray-300"
  );
};

// ì˜ˆì•½ê´€ë¦¬ ìƒì„¸ ëª¨ë‹¬
const showReservationDetails = (reservation) => {
  selectedReservation.value = { ...reservation, memo: reservation.memo || "" };
};
// ì˜ˆì•½ìƒì„¸ ëª¨ë‹¬ ë‹«ê¸°
const closeModal = () => {
  selectedReservation.value = null;
};
// ì˜ˆì•½ ì •ë³´ ì €ì¥ í•¨ìˆ˜
const saveReservaton = () => {
  // ì…ë ¥ê°’ ìœ íš¨ì„± ê²€ì‚¬
  if (
    !selectedReservation.value.customerName ||
    !selectedReservation.value.date
  ) {
    alert("ê³ ê°ëª…ê³¼ ì˜ˆì•½ì¼ì‹œëŠ” í•„ìˆ˜ ì…ë ¥ í•­ëª©ì…ë‹ˆë‹¤.");
    return;
  }
  const index = reservations.value.findIndex(
    (r) => r.id === selectedReservation.value.id
  );
  if (index !== -1) {
    reservations.value[index] = { ...selectedReservation.value };
  }
  //   ëª¨ë‹¬ë‹«ê¸°
  closeModal();
};

// ìµœê·¼ì˜ˆì•½
const recentReservations = ref([
  { id: 1, customerName: "ê¹€ì² ìˆ˜", date: "2024-03-20", status: "í™•ì •" },
  { id: 2, customerName: "ì´ì˜í¬", date: "2024-03-21", status: "ëŒ€ê¸°" },
  { id: 3, customerName: "ë°•ë¯¼ìˆ˜", date: "2024-03-22", status: "ì·¨ì†Œ" },
  { id: 4, customerName: "ì •ì§€ì€", date: "2024-03-23", status: "í™•ì •" },
]);
</script>
